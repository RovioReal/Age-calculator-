<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Futuristic Age Calculator</title>
    <!-- Favicon (optional, replace with your own or remove) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚è≥</text></svg>">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- GSAP Animation Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js" integrity="sha512-7eHRwcbYkK4d9g/6tD/mhkf++eoTHwpNM9woBxtPUBWm67zeAfFC+HrdoE2GanKeocly/VxeLvIqwvCdk7qScg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <style>
        /* ------------------------- */
        /* --- CSS Reset & Globals --- */
        /* ------------------------- */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --font-primary: 'Roboto', sans-serif;
            --font-display: 'Orbitron', sans-serif;

            /* Light Theme */
            --bg-color-light: #f4f7f9;
            --text-color-light: #333;
            --card-bg-light: #ffffff;
            --primary-color-light: #007bff;
            --accent-color-light: #6f42c1;
            --border-color-light: #dee2e6;
            --shadow-light: 0 4px 15px rgba(0, 0, 0, 0.08);
            --input-bg-light: #e9ecef;
            --input-text-light: #495057;
            --icon-color-light: #555;

            /* Dark Theme */
            --bg-color-dark: #1a1d24;
            --text-color-dark: #e0e0e0;
            --card-bg-dark: #2c303a;
            --primary-color-dark: #4dabf7;
            --accent-color-dark: #9b59b6;
            --border-color-dark: #444;
            --shadow-dark: 0 6px 20px rgba(0, 0, 0, 0.3);
            --input-bg-dark: #3a3f4b;
            --input-text-dark: #e0e0e0;
            --icon-color-dark: #bbb;

            /* Default to Light Theme */
            --bg-color: var(--bg-color-light);
            --text-color: var(--text-color-light);
            --card-bg: var(--card-bg-light);
            --primary-color: var(--primary-color-light);
            --accent-color: var(--accent-color-light);
            --border-color: var(--border-color-light);
            --shadow: var(--shadow-light);
            --input-bg: var(--input-bg-light);
            --input-text: var(--input-text-light);
            --icon-color: var(--icon-color-light);

            --border-radius: 8px;
            --transition-speed: 0.4s;
        }

        body {
            font-family: var(--font-primary);
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
            overflow-x: hidden; /* Prevent horizontal scroll */
            padding: 20px; /* Add padding for smaller screens */
        }

        body.dark-mode {
            --bg-color: var(--bg-color-dark);
            --text-color: var(--text-color-dark);
            --card-bg: var(--card-bg-dark);
            --primary-color: var(--primary-color-dark);
            --accent-color: var(--accent-color-dark);
            --border-color: var(--border-color-dark);
            --shadow: var(--shadow-dark);
            --input-bg: var(--input-bg-dark);
            --input-text: var(--input-text-dark);
            --icon-color: var(--icon-color-dark);
        }

        /* ------------------------- */
        /* --- Utility Classes --- */
        /* ------------------------- */
        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            transition: background-color var(--transition-speed) ease,
                        border-color var(--transition-speed) ease,
                        box-shadow var(--transition-speed) ease;
            overflow: hidden; /* Contain child animations */
            opacity: 0; /* Initially hidden for GSAP */
            transform: translateY(20px); /* Initially moved down for GSAP */
        }

        h1, h2, h3 {
            font-family: var(--font-display);
            color: var(--primary-color);
            margin-bottom: 20px;
            transition: color var(--transition-speed) ease;
            text-align: center;
            font-weight: 700;
        }
        h1 { font-size: 2.8rem; margin-bottom: 40px; }
        h2 { font-size: 1.8rem; }
        h3 { font-size: 1.4rem; color: var(--accent-color); }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 700;
            color: var(--text-color);
            transition: color var(--transition-speed) ease;
        }

        input[type="date"],
        input[type="text"] { /* Added text for potential future use */
            width: 100%;
            padding: 12px 15px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            background-color: var(--input-bg);
            color: var(--input-text);
            font-family: var(--font-primary);
            font-size: 1rem;
            transition: background-color var(--transition-speed) ease,
                        color var(--transition-speed) ease,
                        border-color var(--transition-speed) ease,
                        box-shadow 0.2s ease;
            appearance: none; /* Attempt to style date picker appearance */
            -webkit-appearance: none;
            -moz-appearance: none;
        }
        /* Style the date picker indicator */
         input[type="date"]::-webkit-calendar-picker-indicator {
            cursor: pointer;
            opacity: 0.8;
            filter: invert(var(--theme-icon-filter, 0)); /* Invert in dark mode if needed */
            transition: opacity 0.2s ease, filter var(--transition-speed) ease;
        }
        body.dark-mode input[type="date"]::-webkit-calendar-picker-indicator {
             filter: invert(1) brightness(0.8); /* Adjust filter for dark mode */
        }
         input[type="date"]::-webkit-calendar-picker-indicator:hover {
            opacity: 1;
        }


        input[type="date"]:focus,
        input[type="text"]:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(var(--rgb-primary, 0, 123, 255), 0.25); /* Use RGB version for shadow */
        }
        /* Dynamically set RGB values based on theme */
        body:not(.dark-mode) { --rgb-primary: 0, 123, 255; }
        body.dark-mode { --rgb-primary: 77, 171, 247; }

        button {
            display: inline-block;
            background-color: var(--primary-color);
            color: #fff;
            padding: 12px 25px;
            border: none;
            border-radius: var(--border-radius);
            font-family: var(--font-display);
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        button:hover {
            filter: brightness(1.1);
        }

        button:active {
            transform: scale(0.98);
        }

        .icon {
            margin-right: 8px;
            color: var(--icon-color);
            transition: color var(--transition-speed) ease;
            width: 20px; /* Ensure consistent icon width */
            text-align: center;
        }

        /* Flex helpers */
        .d-flex { display: flex; }
        .justify-content-between { justify-content: space-between; }
        .justify-content-center { justify-content: center; }
        .align-items-center { align-items: center; }
        .flex-wrap { flex-wrap: wrap; }
        .flex-column { flex-direction: column; }
        .gap-20 { gap: 20px; }
        .gap-30 { gap: 30px; }


        /* ------------------------- */
        /* --- Theme Toggle --- */
        /* ------------------------- */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: background-color var(--transition-speed) ease,
                        border-color var(--transition-speed) ease,
                        transform 0.3s ease;
        }
        .theme-toggle:hover {
            transform: scale(1.1);
        }
        .theme-toggle i {
            font-size: 1.2rem;
            color: var(--accent-color);
            transition: color var(--transition-speed) ease, transform 0.4s ease;
        }
        /* Rotate icons during theme change */
        .theme-toggle .fa-sun { display: block; }
        .theme-toggle .fa-moon { display: none; }
        body.dark-mode .theme-toggle .fa-sun { display: none; }
        body.dark-mode .theme-toggle .fa-moon { display: block; }
        body.dark-mode .theme-toggle i { transform: rotate(360deg); }


        /* ------------------------- */
        /* --- Age Display Section --- */
        /* ------------------------- */
        #ageResult, #liveAgeCounter, #birthdayCountdownResult, #zodiacInfo, #dateDiffResult, #milestoneSection {
            margin-top: 25px;
            opacity: 0; /* Initially hidden for GSAP */
            /* No transform needed here, will be handled by stagger */
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            text-align: center;
        }

        .result-item {
            background-color: rgba(var(--rgb-primary), 0.1); /* Use RGB for alpha */
            padding: 20px 15px;
            border-radius: var(--border-radius);
            border-left: 5px solid var(--primary-color);
            transition: background-color var(--transition-speed) ease, border-color var(--transition-speed) ease;
        }

        .result-item span {
            display: block;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            font-family: var(--font-display);
            margin-bottom: 5px;
            transition: color var(--transition-speed) ease;
        }

        .result-item p {
            font-size: 0.9rem;
            color: var(--text-color);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 400;
            transition: color var(--transition-speed) ease;
        }

        /* Live Counter specific styles */
        #liveAgeCounter .result-grid {
             grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        }
        #liveAgeCounter .result-item {
             border-left-color: var(--accent-color);
             background-color: rgba(var(--rgb-accent), 0.1); /* Use RGB for alpha */
        }
        #liveAgeCounter .result-item span {
            color: var(--accent-color);
        }
        /* Dynamically set RGB values for accent based on theme */
        body:not(.dark-mode) { --rgb-accent: 111, 66, 193; }
        body.dark-mode { --rgb-accent: 155, 89, 182; }

        /* Birthday Countdown styles */
        #birthdayCountdownResult .result-item {
            border-left-color: #28a745; /* Green accent for countdown */
            background-color: rgba(40, 167, 69, 0.1);
        }
        #birthdayCountdownResult .result-item span {
            color: #28a745;
        }


        /* ------------------------- */
        /* --- Zodiac & Birthstone --- */
        /* ------------------------- */
        #zodiacInfo .info-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background-color: var(--input-bg);
            border-radius: var(--border-radius);
            margin-bottom: 15px;
            transition: background-color var(--transition-speed) ease;
        }
        #zodiacInfo .info-item i {
            font-size: 1.5rem;
            min-width: 40px; /* Ensure alignment */
            text-align: center;
            margin-right: 15px;
            color: var(--accent-color);
            transition: color var(--transition-speed) ease;
        }
        #zodiacInfo .info-item span {
            font-weight: 700;
            margin-right: 10px;
        }


        /* ------------------------- */
        /* --- Date Difference --- */
        /* ------------------------- */
        .date-diff-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        #dateDiffResult p {
            font-size: 1.1rem;
            font-weight: 700;
            text-align: center;
            color: var(--primary-color);
            transition: color var(--transition-speed) ease;
        }
        #dateDiffResult p span {
             font-family: var(--font-display);
             font-size: 1.3rem;
             margin-left: 5px;
        }

        /* ------------------------- */
        /* --- Milestone Timeline --- */
        /* ------------------------- */
        #milestoneSection {
            position: relative;
            padding: 40px 0;
        }

        .timeline-container {
            position: relative;
            width: 100%;
            padding: 20px 0;
            overflow-x: auto; /* Enable horizontal scrolling for timeline */
            overflow-y: hidden;
            white-space: nowrap; /* Keep items in a line */
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
            scrollbar-width: thin; /* Firefox */
            scrollbar-color: var(--primary-color) var(--input-bg); /* Firefox */
        }
        /* Webkit scrollbar styling */
        .timeline-container::-webkit-scrollbar {
            height: 8px;
        }
        .timeline-container::-webkit-scrollbar-track {
            background: var(--input-bg);
            border-radius: 4px;
        }
        .timeline-container::-webkit-scrollbar-thumb {
            background-color: var(--primary-color);
            border-radius: 4px;
            border: 2px solid var(--input-bg); /* Creates padding around thumb */
        }


        .timeline-line {
            position: absolute;
            left: 0;
            top: 50%;
            height: 4px;
            background-color: var(--border-color);
            width: 100%; /* Will be dynamically adjusted by JS */
            min-width: 100%; /* Ensure it spans at least the container */
            transform: translateY(-50%);
            z-index: 1;
            transition: background-color var(--transition-speed) ease;
        }
        .timeline-progress {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            background-color: var(--primary-color);
            width: 0; /* Will be set by JS */
            z-index: 2;
            transition: width 1s ease-out, background-color var(--transition-speed) ease;
        }

        .milestone {
            display: inline-block; /* Arrange horizontally */
            position: relative;
            width: 150px; /* Width of each milestone item */
            text-align: center;
            z-index: 3;
            vertical-align: top; /* Align items at the top */
            margin: 0 20px; /* Spacing between milestones */
            opacity: 0; /* Initially hidden for GSAP */
            transform: translateY(15px); /* Initial offset for GSAP */
        }
        .milestone:first-child { margin-left: 40px; } /* Add padding at the start */
        .milestone:last-child { margin-right: 40px; } /* Add padding at the end */


        .milestone-marker {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 16px;
            height: 16px;
            background-color: var(--card-bg);
            border: 3px solid var(--border-color);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: border-color 0.5s ease, background-color 0.5s ease;
            z-index: 4; /* Above the line */
        }

        .milestone-content {
            padding-top: 30px; /* Space above the text, below the marker */
            position: relative; /* Needed for pseudo-element connector */
            margin-top: -8px; /* Adjust vertical alignment slightly */
        }
        .milestone-content::before { /* Connector line from marker to content */
            content: '';
            position: absolute;
            top: -12px; /* Position start just below the marker */
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 20px; /* Length of the connector */
            background-color: var(--border-color);
            transition: background-color 0.5s ease;
            z-index: 3;
        }

        .milestone-age {
            font-family: var(--font-display);
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--accent-color);
            display: block;
            margin-bottom: 5px;
            transition: color var(--transition-speed) ease;
        }

        .milestone-date {
            font-size: 0.8rem;
            color: var(--text-color);
            opacity: 0.8;
            display: block;
            white-space: normal; /* Allow date to wrap if needed */
            transition: color var(--transition-speed) ease;
        }

        /* Milestone Achieved State */
        .milestone.achieved .milestone-marker {
            border-color: var(--primary-color);
            background-color: var(--primary-color);
        }
        .milestone.achieved .milestone-content::before {
            background-color: var(--primary-color);
        }
        .milestone.achieved .milestone-age {
            color: var(--primary-color);
        }

        /* Milestone Next Upcoming State */
        .milestone.next-milestone .milestone-marker {
            border-color: var(--accent-color);
            background-color: var(--card-bg); /* Keep bg same as card */
            animation: pulse 2s infinite ease-in-out;
        }
         .milestone.next-milestone .milestone-content::before {
             background-color: var(--accent-color);
        }
        .milestone.next-milestone .milestone-age {
             color: var(--accent-color);
        }
        @keyframes pulse {
            0% { transform: translate(-50%, -50%) scale(1); box-shadow: 0 0 0 0 rgba(var(--rgb-accent), 0.4); }
            70% { transform: translate(-50%, -50%) scale(1); box-shadow: 0 0 0 10px rgba(var(--rgb-accent), 0); }
            100% { transform: translate(-50%, -50%) scale(1); box-shadow: 0 0 0 0 rgba(var(--rgb-accent), 0); }
        }


        /* ------------------------- */
        /* --- Responsive Design --- */
        /* ------------------------- */
        @media (max-width: 992px) {
            h1 { font-size: 2.4rem; }
            h2 { font-size: 1.6rem; }
            h3 { font-size: 1.3rem; }
            .card { padding: 25px; }
        }

        @media (max-width: 768px) {
            .container { padding: 0 15px; margin-top: 20px; }
            h1 { font-size: 2rem; margin-bottom: 30px; }
            .result-grid { grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 15px; }
            .result-item span { font-size: 1.5rem; }
            .result-item p { font-size: 0.8rem; }
            .date-diff-inputs { grid-template-columns: 1fr; gap: 0; }
            .date-diff-inputs div:first-child input { margin-bottom: 10px; }
            .milestone { width: 130px; margin: 0 10px; } /* Smaller milestones */
             .milestone:first-child { margin-left: 20px; }
             .milestone:last-child { margin-right: 20px; }
             .theme-toggle { width: 40px; height: 40px; top: 15px; right: 15px; }
             .theme-toggle i { font-size: 1rem; }
             body { padding: 15px 10px; } /* Adjust body padding */
        }

        @media (max-width: 576px) {
            h1 { font-size: 1.8rem; }
            h2 { font-size: 1.4rem; }
            .card { padding: 20px; }
            button { padding: 10px 20px; font-size: 0.9rem; }
            .result-grid { grid-template-columns: repeat(2, 1fr); } /* Force 2 columns on small screens */
            #liveAgeCounter .result-grid { grid-template-columns: repeat(3, 1fr); } /* 3 columns for live timer */
             #birthdayCountdownResult .result-grid { grid-template-columns: repeat(2, 1fr); gap: 10px;}
             #birthdayCountdownResult .result-item { padding: 15px 10px; }
             #zodiacInfo .info-item { flex-direction: column; align-items: flex-start; text-align: left; }
             #zodiacInfo .info-item i { margin-bottom: 5px; margin-right: 0; }
             .milestone { width: 110px; }
             .milestone-age { font-size: 1.1rem; }
             .milestone-date { font-size: 0.75rem; }
             body { padding: 10px 5px; } /* Further reduce padding */
        }


        /* ------------------------------ */
        /* --- Initial Animation States --- */
        /* ------------------------------ */
        /* Elements initially hidden by GSAP */
        #ageResult, #liveAgeCounter, #birthdayCountdownResult, #zodiacInfo, #dateDiffResult, #milestoneSection, .milestone, .card {
             visibility: hidden; /* Use visibility to prevent layout shifts before animation */
        }


    </style>
</head>
<body>

    <!-- Theme Toggle Button -->
    <div class="theme-toggle" id="themeToggle" title="Toggle Theme">
        <i class="fas fa-sun"></i>
        <i class="fas fa-moon"></i>
    </div>

    <div class="container">
        <h1><i class="fas fa-hourglass-half icon"></i>Futuristic Age Calculator</h1>

        <!-- Main Age Calculator Card -->
        <div class="card" id="ageCalculatorCard">
            <h2><i class="fas fa-calendar-alt icon"></i>Calculate Your Precise Age</h2>
            <label for="dobInput">Enter Your Date of Birth:</label>
            <input type="date" id="dobInput" name="dobInput" max=""> <!-- Max date will be set by JS -->

            <div class="d-flex justify-content-center">
                 <button id="calculateAgeBtn"><i class="fas fa-calculator"></i> Calculate Age</button>
            </div>


            <!-- Age Result Display -->
            <div id="ageResult">
                <h3 style="margin-top: 30px;">Your Age Is:</h3>
                <div class="result-grid" id="ageResultGrid">
                    <!-- Results will be populated here by JS -->
                </div>
            </div>

            <!-- Live Age Counter -->
            <div id="liveAgeCounter">
                 <h3 style="margin-top: 30px;">Counting Every Second:</h3>
                 <div class="result-grid" id="liveCounterGrid">
                     <!-- Live counter will be populated here by JS -->
                 </div>
            </div>

             <!-- Birthday Countdown -->
             <div id="birthdayCountdownResult">
                  <h3 style="margin-top: 30px;">Next Birthday Countdown:</h3>
                  <div class="result-grid" id="countdownGrid">
                      <!-- Countdown will be populated here by JS -->
                  </div>
             </div>

              <!-- Zodiac and Birthstone Info -->
             <div id="zodiacInfo">
                  <h3 style="margin-top: 30px;">Birth Insights:</h3>
                  <div id="zodiacContainer">
                      <!-- Zodiac/Birthstone info will be populated here by JS -->
                  </div>
             </div>
        </div>

        <!-- Milestone Timeline Card -->
        <div class="card" id="milestoneCard">
             <h2><i class="fas fa-chart-line icon"></i>Your Life Milestones</h2>
             <div id="milestoneSection">
                 <div class="timeline-container" id="timelineContainer">
                     <div class="timeline-line">
                         <div class="timeline-progress" id="timelineProgress"></div>
                     </div>
                     <div id="milestonesWrapper">
                         <!-- Milestones will be populated here by JS -->
                     </div>
                 </div>
             </div>
             <p id="milestoneMessage" style="text-align:center; margin-top: 10px; font-style: italic; opacity: 0.7;"></p>
        </div>


        <!-- Date Difference Calculator Card -->
        <div class="card" id="dateDifferenceCard">
            <h2><i class="fas fa-exchange-alt icon"></i>Calculate Difference Between Dates</h2>
            <div class="date-diff-inputs">
                <div>
                    <label for="date1">Start Date:</label>
                    <input type="date" id="date1" name="date1" max="">
                </div>
                <div>
                    <label for="date2">End Date:</label>
                    <input type="date" id="date2" name="date2" max="">
                </div>
            </div>
             <div class="d-flex justify-content-center">
                <button id="calculateDiffBtn"><i class="fas fa-arrows-alt-h"></i> Calculate Difference</button>
             </div>

            <div id="dateDiffResult" style="margin-top: 25px;">
                <!-- Difference result will be populated here by JS -->
            </div>
        </div>

    </div><!-- /.container -->


    <script>
    // Wait for the DOM to be fully loaded
    document.addEventListener('DOMContentLoaded', () => {

        // --- DOM Element Selection ---
        const dobInput = document.getElementById('dobInput');
        const calculateAgeBtn = document.getElementById('calculateAgeBtn');
        const ageResultDiv = document.getElementById('ageResult');
        const ageResultGrid = document.getElementById('ageResultGrid');
        const liveAgeCounterDiv = document.getElementById('liveAgeCounter');
        const liveCounterGrid = document.getElementById('liveCounterGrid');
        const birthdayCountdownDiv = document.getElementById('birthdayCountdownResult');
        const countdownGrid = document.getElementById('countdownGrid');
        const zodiacInfoDiv = document.getElementById('zodiacInfo');
        const zodiacContainer = document.getElementById('zodiacContainer');

        const date1Input = document.getElementById('date1');
        const date2Input = document.getElementById('date2');
        const calculateDiffBtn = document.getElementById('calculateDiffBtn');
        const dateDiffResultDiv = document.getElementById('dateDiffResult');

        const themeToggleBtn = document.getElementById('themeToggle');
        const body = document.body;

        const milestoneSection = document.getElementById('milestoneSection');
        const milestonesWrapper = document.getElementById('milestonesWrapper');
        const timelineContainer = document.getElementById('timelineContainer');
        const timelineLine = document.querySelector('.timeline-line');
        const timelineProgress = document.getElementById('timelineProgress');
        const milestoneMessage = document.getElementById('milestoneMessage');

        // Cards for animation
        const ageCalculatorCard = document.getElementById('ageCalculatorCard');
        const milestoneCard = document.getElementById('milestoneCard');
        const dateDifferenceCard = document.getElementById('dateDifferenceCard');


        // --- Global Variables ---
        let ageInterval; // For live age counter
        let countdownInterval; // For birthday countdown
        const now = new Date();
        const todayStr = now.toISOString().split('T')[0]; // YYYY-MM-DD format

        // --- Initialization ---
        function initializeApp() {
            // Set max date for date inputs to today
            dobInput.max = todayStr;
            date1Input.max = todayStr;
            date2Input.max = todayStr;

            // Apply saved theme
            const savedTheme = localStorage.getItem('theme') || 'light';
            if (savedTheme === 'dark') {
                body.classList.add('dark-mode');
            }
             updateThemeIcon(); // Set initial icon state

            // Initial Animations (using GSAP)
             gsap.to([ageCalculatorCard, milestoneCard, dateDifferenceCard], {
                duration: 0.8,
                y: 0,
                opacity: 1,
                visibility: 'visible', // Make visible after animation starts
                stagger: 0.2,
                ease: "power2.out",
                delay: 0.2
             });
        }

        // --- Theme Toggler ---
        themeToggleBtn.addEventListener('click', () => {
            body.classList.toggle('dark-mode');
            const currentTheme = body.classList.contains('dark-mode') ? 'dark' : 'light';
            localStorage.setItem('theme', currentTheme);
             updateThemeIcon();

             // Animate theme icon (can be simple CSS or GSAP for more control)
             gsap.fromTo(themeToggleBtn.querySelector('i'),
                 { rotation: 0, scale: 0.8, opacity: 0 },
                 { rotation: 360, scale: 1, opacity: 1, duration: 0.5, ease: 'back.out(1.7)' }
             );
        });

         function updateThemeIcon() {
             // This relies on the CSS display properties set for .fa-sun and .fa-moon
             // No JS needed to swap icons if CSS handles it based on body class
         }


        // --- Helper Functions ---
        function padZero(num) {
            return num.toString().padStart(2, '0');
        }

        function animateResultDisplay(element, stagger = 0.1) {
            gsap.to(element, { duration: 0.5, opacity: 1, visibility: 'visible', ease: 'power1.inOut' });
            const items = element.querySelectorAll('.result-item, .info-item, p'); // Target relevant children
             if(items.length > 0) {
                gsap.fromTo(items,
                    { opacity: 0, y: 15 },
                    { duration: 0.4, opacity: 1, y: 0, stagger: stagger, ease: 'power2.out', delay: 0.2 }
                );
             }
        }

        // --- Core Age Calculation Logic ---
        function calculateAge(dob) {
            const birthDate = new Date(dob);
            const currentDate = new Date();

            if (isNaN(birthDate.getTime())) {
                return null; // Invalid date
            }

            let years = currentDate.getFullYear() - birthDate.getFullYear();
            let months = currentDate.getMonth() - birthDate.getMonth();
            let days = currentDate.getDate() - birthDate.getDate();

            let totalSeconds = Math.floor((currentDate - birthDate) / 1000);
            let totalMinutes = Math.floor(totalSeconds / 60);
            let totalHours = Math.floor(totalMinutes / 60);
            let totalDays = Math.floor(totalHours / 24);

            let seconds = totalSeconds % 60;
            let minutes = totalMinutes % 60;
            let hours = totalHours % 24;


            // Adjust months and years if current date's month/day is before birth date's
            if (days < 0) {
                months--;
                // Get days in the previous month
                const prevMonth = new Date(currentDate.getFullYear(), currentDate.getMonth(), 0);
                days += prevMonth.getDate();
            }

            if (months < 0) {
                years--;
                months += 12;
            }

            // Precise remaining days, hours, minutes, seconds for live counter
             const nextBirthdayThisYear = new Date(currentDate.getFullYear(), birthDate.getMonth(), birthDate.getDate());
             const nextBirthdayNextYear = new Date(currentDate.getFullYear() + 1, birthDate.getMonth(), birthDate.getDate());

             let nextBirthday;
             if (currentDate < nextBirthdayThisYear) {
                 nextBirthday = nextBirthdayThisYear;
             } else {
                 nextBirthday = nextBirthdayNextYear;
             }

            const timeUntilBirthday = nextBirthday - currentDate;
            const daysUntil = Math.floor(timeUntilBirthday / (1000 * 60 * 60 * 24));
            const hoursUntil = Math.floor((timeUntilBirthday % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutesUntil = Math.floor((timeUntilBirthday % (1000 * 60 * 60)) / (1000 * 60));
            const secondsUntil = Math.floor((timeUntilBirthday % (1000 * 60)) / 1000);


            return {
                years, months, days,
                totalDays, totalHours: Math.floor((currentDate - birthDate) / (1000 * 60 * 60)), // Recalculate total hours for display
                totalMinutes: Math.floor((currentDate - birthDate) / (1000 * 60)), // Recalculate total minutes
                totalSeconds: Math.floor((currentDate - birthDate) / 1000), // Recalculate total seconds
                liveHours: hours, liveMinutes: minutes, liveSeconds: seconds, // For the live counter part
                countdown: { days: daysUntil, hours: hoursUntil, minutes: minutesUntil, seconds: secondsUntil },
                birthDate // Return the parsed birthDate object
            };
        }

        // --- Live Age Counter Update ---
        function startLiveCounter(birthDate) {
            clearInterval(ageInterval); // Clear any existing interval

             function updateCounter() {
                const currentDate = new Date();
                const diff = currentDate - birthDate;

                if (diff < 0) { // Should not happen with max date set, but safety check
                    clearInterval(ageInterval);
                    liveCounterGrid.innerHTML = '<p>Invalid Date</p>';
                    return;
                }

                let totalSeconds = Math.floor(diff / 1000);
                let totalMinutes = Math.floor(totalSeconds / 60);
                let totalHours = Math.floor(totalMinutes / 60);

                let seconds = totalSeconds % 60;
                let minutes = totalMinutes % 60;
                let hours = totalHours % 24; // Hours within the current day since birth time (approx)

                // Update the specific live counter grid items
                 // Assumes elements exist with specific IDs or classes
                 const hoursEl = liveCounterGrid.querySelector('.live-hours span');
                 const minutesEl = liveCounterGrid.querySelector('.live-minutes span');
                 const secondsEl = liveCounterGrid.querySelector('.live-seconds span');

                 if (hoursEl) hoursEl.textContent = padZero(hours);
                 if (minutesEl) minutesEl.textContent = padZero(minutes);
                 if (secondsEl) secondsEl.textContent = padZero(seconds);

                 // GSAP animation for seconds tick (optional, can be subtle)
                 if (secondsEl) {
                    gsap.fromTo(secondsEl, { scale: 1.1, color: 'var(--accent-color)' }, { scale: 1, color: 'var(--accent-color)', duration: 0.3, ease: 'power1.out' });
                 }
             }


            // Initial setup of live counter structure if not present
             if (!liveCounterGrid.querySelector('.live-hours')) {
                 liveCounterGrid.innerHTML = `
                    <div class="result-item live-hours"><span>${padZero(0)}</span><p>Hours</p></div>
                    <div class="result-item live-minutes"><span>${padZero(0)}</span><p>Minutes</p></div>
                    <div class="result-item live-seconds"><span>${padZero(0)}</span><p>Seconds</p></div>
                `;
             }


            updateCounter(); // Run immediately
            ageInterval = setInterval(updateCounter, 1000); // Update every second
        }

        // --- Birthday Countdown Update ---
         function startBirthdayCountdown(birthDate) {
            clearInterval(countdownInterval);

             function updateCountdown() {
                 const currentDate = new Date();
                 const birthMonth = birthDate.getMonth();
                 const birthDay = birthDate.getDate();

                 let nextBirthdayYear = currentDate.getFullYear();
                 let nextBirthday = new Date(nextBirthdayYear, birthMonth, birthDay);

                 // If the birthday this year has already passed, set it for next year
                 if (currentDate > nextBirthday) {
                     nextBirthdayYear++;
                     nextBirthday = new Date(nextBirthdayYear, birthMonth, birthDay);
                 }

                 const timeUntilBirthday = nextBirthday - currentDate;

                 if (timeUntilBirthday <= 0) { // It's currently the birthday!
                     countdownGrid.innerHTML = `<div class="result-item birthday-today" style="grid-column: 1 / -1; background-color: rgba(40, 167, 69, 0.2); border-color: #28a745;"><span>üéÇ</span><p>Happy Birthday!</p></div>`;
                     clearInterval(countdownInterval);
                     return;
                 }

                 const days = Math.floor(timeUntilBirthday / (1000 * 60 * 60 * 24));
                 const hours = Math.floor((timeUntilBirthday % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                 const minutes = Math.floor((timeUntilBirthday % (1000 * 60 * 60)) / (1000 * 60));
                 const seconds = Math.floor((timeUntilBirthday % (1000 * 60)) / 1000);

                 // Update DOM
                 const daysEl = countdownGrid.querySelector('.countdown-days span');
                 const hoursEl = countdownGrid.querySelector('.countdown-hours span');
                 const minutesEl = countdownGrid.querySelector('.countdown-minutes span');
                 const secondsEl = countdownGrid.querySelector('.countdown-seconds span');

                 if (daysEl) daysEl.textContent = days;
                 if (hoursEl) hoursEl.textContent = padZero(hours);
                 if (minutesEl) minutesEl.textContent = padZero(minutes);
                 if (secondsEl) secondsEl.textContent = padZero(seconds);

                 // Optional subtle animation for seconds
                 if (secondsEl) {
                    gsap.fromTo(secondsEl, { y: -3, opacity: 0.8 }, { y: 0, opacity: 1, duration: 0.4, ease: 'power1.in' });
                 }
             }

             // Initial setup of countdown structure
             if (!countdownGrid.querySelector('.countdown-days')) {
                countdownGrid.innerHTML = `
                    <div class="result-item countdown-days"><span>0</span><p>Days</p></div>
                    <div class="result-item countdown-hours"><span>00</span><p>Hours</p></div>
                    <div class="result-item countdown-minutes"><span>00</span><p>Minutes</p></div>
                    <div class="result-item countdown-seconds"><span>00</span><p>Seconds</p></div>
                `;
             }

             updateCountdown(); // Run immediately
             countdownInterval = setInterval(updateCountdown, 1000);
         }

        // --- Zodiac & Birthstone Logic ---
        function getZodiacSign(month, day) { // month is 1-12
            if ((month == 3 && day >= 21) || (month == 4 && day <= 19)) return { sign: "Aries", icon: "‚ôà" };
            if ((month == 4 && day >= 20) || (month == 5 && day <= 20)) return { sign: "Taurus", icon: "‚ôâ" };
            if ((month == 5 && day >= 21) || (month == 6 && day <= 20)) return { sign: "Gemini", icon: "‚ôä" };
            if ((month == 6 && day >= 21) || (month == 7 && day <= 22)) return { sign: "Cancer", icon: "‚ôã" };
            if ((month == 7 && day >= 23) || (month == 8 && day <= 22)) return { sign: "Leo", icon: "‚ôå" };
            if ((month == 8 && day >= 23) || (month == 9 && day <= 22)) return { sign: "Virgo", icon: "‚ôç" };
            if ((month == 9 && day >= 23) || (month == 10 && day <= 22)) return { sign: "Libra", icon: "‚ôé" };
            if ((month == 10 && day >= 23) || (month == 11 && day <= 21)) return { sign: "Scorpio", icon: "‚ôè" };
            if ((month == 11 && day >= 22) || (month == 12 && day <= 21)) return { sign: "Sagittarius", icon: "‚ôê" };
            if ((month == 12 && day >= 22) || (month == 1 && day <= 19)) return { sign: "Capricorn", icon: "‚ôë" };
            if ((month == 1 && day >= 20) || (month == 2 && day <= 18)) return { sign: "Aquarius", icon: "‚ôí" };
            if ((month == 2 && day >= 19) || (month == 3 && day <= 20)) return { sign: "Pisces", icon: "‚ôì" };
            return { sign: "Unknown", icon: "?" };
        }

        function getBirthstone(month) { // month is 1-12
            const stones = [
                "Garnet", "Amethyst", "Aquamarine", "Diamond", "Emerald", "Pearl/Alexandrite",
                "Ruby", "Peridot/Spinel/Sardonyx", "Sapphire", "Opal/Tourmaline", "Topaz/Citrine", "Turquoise/Tanzanite/Zircon"
            ];
            return stones[month - 1] || "Unknown";
        }

        function displayZodiacInfo(birthDate) {
            const month = birthDate.getMonth() + 1; // getMonth is 0-indexed
            const day = birthDate.getDate();

            const { sign, icon: zodiacIcon } = getZodiacSign(month, day);
            const birthstone = getBirthstone(month);

            zodiacContainer.innerHTML = `
                <div class="info-item">
                    <i class="fas fa-meteor icon" title="Zodiac Sign"></i>
                    <div><span>Zodiac Sign:</span> ${sign} (${zodiacIcon})</div>
                </div>
                <div class="info-item">
                    <i class="fas fa-gem icon" title="Birthstone"></i>
                     <div><span>Birthstone:</span> ${birthstone}</div>
                </div>
            `;
             animateResultDisplay(zodiacInfoDiv, 0.15);
        }

        // --- Milestone Timeline Logic ---
        function calculateMilestoneDates(birthDate) {
             const milestones = [1, 5, 10, 13, 16, 18, 21, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 90, 100];
             const milestoneDates = milestones.map(age => {
                 const milestoneDate = new Date(birthDate);
                 milestoneDate.setFullYear(birthDate.getFullYear() + age);
                 return { age: age, date: milestoneDate };
             });
             return milestoneDates;
        }

        function displayMilestones(birthDate) {
            const milestoneData = calculateMilestoneDates(birthDate);
            const currentDate = new Date();
            let achievedCount = 0;
            let nextMilestoneIndex = -1;
            let html = '';

            milestoneData.forEach((milestone, index) => {
                const dateString = milestone.date.toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: 'numeric' });
                let statusClass = '';
                if (milestone.date <= currentDate) {
                    statusClass = 'achieved';
                    achievedCount = index + 1;
                 } else if (nextMilestoneIndex === -1) {
                     statusClass = 'next-milestone';
                     nextMilestoneIndex = index;
                 }

                html += `
                    <div class="milestone ${statusClass}" data-age="${milestone.age}">
                        <div class="milestone-marker"></div>
                        <div class="milestone-content">
                            <span class="milestone-age">${milestone.age} Years</span>
                            <span class="milestone-date">${dateString}</span>
                        </div>
                    </div>
                `;
            });

            milestonesWrapper.innerHTML = html;

             // Calculate progress bar width
             const totalMilestones = milestoneData.length;
             const progressPercentage = totalMilestones > 0 ? (achievedCount / totalMilestones) * 100 : 0;

             // Animate progress bar fill
             gsap.to(timelineProgress, { width: `${progressPercentage}%`, duration: 1.5, ease: 'power2.out' });

             // Set total width for the timeline line dynamically based on content
             // Needs a slight delay for elements to render to calculate width properly
             setTimeout(() => {
                const wrapperWidth = milestonesWrapper.scrollWidth;
                timelineLine.style.width = `${wrapperWidth}px`; // Ensure line spans all milestones
                // Adjust container padding if needed to see start/end
                 // timelineContainer.style.paddingLeft = '40px';
                 // timelineContainer.style.paddingRight = '40px';
             }, 100);


            // Animate milestones appearing
             gsap.to(milestoneSection, { duration: 0.5, opacity: 1, visibility: 'visible', ease: 'power1.inOut' });
             gsap.fromTo('.milestone',
                 { opacity: 0, y: 20 },
                 { duration: 0.6, opacity: 1, y: 0, stagger: 0.08, ease: 'back.out(1.2)', delay: 0.3 }
             );

            // Scroll to the next upcoming milestone (if exists)
             if (nextMilestoneIndex !== -1) {
                const nextMilestoneElement = milestonesWrapper.children[nextMilestoneIndex];
                if (nextMilestoneElement) {
                     // Calculate scroll position - try to center it
                     const containerRect = timelineContainer.getBoundingClientRect();
                     const elementRect = nextMilestoneElement.getBoundingClientRect();
                     const scrollOffset = (elementRect.left - containerRect.left) // Distance from container start
                                          + timelineContainer.scrollLeft // Current scroll position
                                          - (containerRect.width / 2) // Center offset
                                          + (elementRect.width / 2); // Center element offset

                    gsap.to(timelineContainer, { scrollTo: { x: scrollOffset, autoKill: false }, duration: 1, ease: 'power2.inOut', delay: 1 }); // Delay scroll slightly
                    milestoneMessage.textContent = `Next milestone: ${milestoneData[nextMilestoneIndex].age} years old!`;
                }
            } else if (achievedCount === totalMilestones) {
                milestoneMessage.textContent = "Congratulations on reaching all major milestones!";
                 // Maybe scroll to end
                 gsap.to(timelineContainer, { scrollTo: { x: 'max' }, duration: 1, ease: 'power2.inOut', delay: 1 });
            } else {
                 milestoneMessage.textContent = "Your journey through time.";
             }
        }

        // --- Date Difference Calculation ---
        function calculateDateDifference(dateStr1, dateStr2) {
            const date1 = new Date(dateStr1);
            const date2 = new Date(dateStr2);

            if (isNaN(date1.getTime()) || isNaN(date2.getTime())) {
                return "Please select two valid dates.";
            }

            // Ensure date1 is earlier than date2
            if (date1 > date2) {
                [date1, date2] = [date2, date1]; // Swap dates
            }

            let years = date2.getFullYear() - date1.getFullYear();
            let months = date2.getMonth() - date1.getMonth();
            let days = date2.getDate() - date1.getDate();

            if (days < 0) {
                months--;
                const prevMonth = new Date(date2.getFullYear(), date2.getMonth(), 0);
                days += prevMonth.getDate();
            }

            if (months < 0) {
                years--;
                months += 12;
            }

            const totalDays = Math.floor(Math.abs(date2 - date1) / (1000 * 60 * 60 * 24));

            let result = "";
             if (years > 0) result += `<span>${years}</span> year${years > 1 ? 's' : ''}`;
             if (months > 0) result += `${result ? ', ' : ''}<span>${months}</span> month${months > 1 ? 's' : ''}`;
             if (days > 0) result += `${result ? ', ' : ''}<span>${days}</span> day${days > 1 ? 's' : ''}`;
             if (!result) result = "<span>0</span> days (Same date selected)";

             result += `<br><em style='font-size: 0.9em; opacity: 0.8; font-weight: 400;'>(Total: <span>${totalDays}</span> days)</em>`;

             return `Difference: ${result}`;
        }


        // --- Event Listeners ---

        // Main Age Calculation Button
        calculateAgeBtn.addEventListener('click', () => {
            const dobValue = dobInput.value;
            if (!dobValue) {
                // Simple visual feedback for empty input
                 gsap.to(dobInput, { x: "+=5", yoyo: true, repeat: 3, duration: 0.1, ease: "power1.inOut" });
                 alert("Please select your date of birth.");
                 return;
            }

            const ageData = calculateAge(dobValue);

            if (ageData) {
                 // Clear previous intervals if any
                 clearInterval(ageInterval);
                 clearInterval(countdownInterval);

                // Populate Age Result Grid
                ageResultGrid.innerHTML = `
                    <div class="result-item"><span>${ageData.years}</span><p>Years</p></div>
                    <div class="result-item"><span>${ageData.months}</span><p>Months</p></div>
                    <div class="result-item"><span>${ageData.days}</span><p>Days</p></div>
                    <div class="result-item"><span>${ageData.totalHours.toLocaleString()}</span><p>Total Hours</p></div>
                    <div class="result-item"><span>${ageData.totalMinutes.toLocaleString()}</span><p>Total Minutes</p></div>
                    <div class="result-item"><span>${ageData.totalSeconds.toLocaleString()}</span><p>Total Seconds</p></div>
                `;
                animateResultDisplay(ageResultDiv);


                 // Start Live Counter Section (pass the exact birthDate object)
                 startLiveCounter(ageData.birthDate);
                 animateResultDisplay(liveAgeCounterDiv, 0.12);

                 // Start Birthday Countdown Section
                 startBirthdayCountdown(ageData.birthDate);
                 animateResultDisplay(birthdayCountdownDiv, 0.1);

                // Display Zodiac Info
                displayZodiacInfo(ageData.birthDate); // Already animated inside the function

                // Display Milestone Timeline
                displayMilestones(ageData.birthDate); // Already animated inside the function

            } else {
                 // Clear previous results and intervals if date is invalid after selection
                 ageResultGrid.innerHTML = '<p>Invalid Date Format</p>';
                 liveCounterGrid.innerHTML = '';
                 countdownGrid.innerHTML = '';
                 zodiacContainer.innerHTML = '';
                 milestonesWrapper.innerHTML = '';
                 timelineProgress.style.width = '0%';
                 milestoneMessage.textContent = '';
                 clearInterval(ageInterval);
                 clearInterval(countdownInterval);
                 // Show error briefly
                 gsap.fromTo(ageResultGrid, {opacity: 0}, {opacity: 1, duration: 0.5});
            }
        });

        // Date Difference Button
        calculateDiffBtn.addEventListener('click', () => {
             const date1Value = date1Input.value;
             const date2Value = date2Input.value;

             if (!date1Value || !date2Value) {
                 alert("Please select both start and end dates.");
                 gsap.to(!date1Value ? date1Input : date2Input, { x: "+=5", yoyo: true, repeat: 3, duration: 0.1, ease: "power1.inOut" });
                 return;
             }

             const difference = calculateDateDifference(date1Value, date2Value);
             dateDiffResultDiv.innerHTML = `<p>${difference}</p>`;
             animateResultDisplay(dateDiffResultDiv); // Animate the result appearing
        });

        // --- Run Initializer ---
        initializeApp();

    }); // End DOMContentLoaded
    </script>

</body>
</html>
